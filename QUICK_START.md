# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç VK Travel Bot (–ª–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ë–ï–ó —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PostgreSQL –∏ –ë–ï–ó –ø—É–±–ª–∏—á–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.

## –ß—Ç–æ –Ω—É–∂–Ω–æ

- Node.js (v16+)
- VK —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ –∫ –≥—Ä—É–ø–ø–µ
- OpenAI API –∫–ª—é—á
- ngrok –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç—É–Ω–Ω–µ–ª—è

## –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd vk-travel-bot
npm install
```

## –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ ngrok

### macOS (—á–µ—Ä–µ–∑ Homebrew):
```bash
brew install ngrok
```

### –ò–ª–∏ —Å–∫–∞—á–∞—Ç—å –≤—Ä—É—á–Ω—É—é:
1. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ https://ngrok.com/download
2. –°–∫–∞—á–∞–π –≤–µ—Ä—Å–∏—é –¥–ª—è macOS
3. –†–∞—Å–ø–∞–∫—É–π –∏ –ø–µ—Ä–µ–º–µ—Å—Ç–∏ –≤ `/usr/local/bin/`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:
```bash
ngrok version
```

## –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `.env`:
```bash
cp .env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏ –ú–ò–ù–ò–ú–ê–õ–¨–ù–û –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è:

```env
# –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–º—è—Ç—å –≤–º–µ—Å—Ç–æ PostgreSQL)
USE_MEMORY_DB=true

# VK API
VK_ACCESS_TOKEN=—Ç–≤–æ–π_—Ç–æ–∫–µ–Ω_vk_–∏–∑_n8n
VK_CONFIRMATION_CODE=–æ—Å—Ç–∞–≤—å_–ø—É—Å—Ç—ã–º_–ø–æ–∫–∞
VK_GROUP_ID=233537605

# OpenAI
OPENAI_API_KEY=—Ç–≤–æ–π_–∫–ª—é—á_openai

# Server
PORT=3000
```

**–í–∞–∂–Ω–æ:**
- `VK_CONFIRMATION_CODE` –∑–∞–ø–æ–ª–Ω–∏—à—å –ø–æ–∑–∂–µ (–®–∞–≥ 6)
- `TELEGRAM_BOT_TOKEN` –º–æ–∂–Ω–æ –Ω–µ –∑–∞–ø–æ–ª–Ω—è—Ç—å –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- PostgreSQL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ –Ω—É–∂–Ω—ã –∫–æ–≥–¥–∞ `USE_MEMORY_DB=true`

## –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

–û—Ç–∫—Ä–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –∑–∞–ø—É—Å—Ç–∏:

```bash
npm run dev
```

–¢—ã —É–≤–∏–¥–∏—à—å:
```
üíæ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è In-Memory –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ)
‚úÖ In-Memory –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞

üöÄ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3000
üì° Webhook endpoint: http://localhost:3000/vk
üíö Health check: http://localhost:3000/health
```

**–ù–ï –ó–ê–ö–†–´–í–ê–ô** —ç—Ç–æ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª!

## –®–∞–≥ 5: –ó–∞–ø—É—Å–∫ ngrok

–û—Ç–∫—Ä–æ–π **–ù–û–í–´–ô** —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –∑–∞–ø—É—Å—Ç–∏ ngrok:

```bash
ngrok http 3000
```

–¢—ã —É–≤–∏–¥–∏—à—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–æ–µ:

```
Session Status                online
Account                       Free
Forwarding                    https://a1b2-c3d4-e5f6.ngrok-free.app -> http://localhost:3000
```

**–í–ê–ñ–ù–û:** –°–∫–æ–ø–∏—Ä—É–π URL –≤–∏–¥–∞ `https://xxxx-xxxx.ngrok-free.app` - —ç—Ç–æ —Ç–≤–æ–π –ø—É–±–ª–∏—á–Ω—ã–π –∞–¥—Ä–µ—Å!

**–ù–ï –ó–ê–ö–†–´–í–ê–ô** —ç—Ç–æ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª, ngrok –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å!

## –®–∞–≥ 6: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VK Callback API

1. –û—Ç–∫—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–≤–æ–µ–π VK –≥—Ä—É–ø–ø—ã
2. –ü–µ—Ä–µ–π–¥–∏: **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** ‚Üí **–†–∞–±–æ—Ç–∞ —Å API** ‚Üí **Callback API**
3. –ù–∞–∂–º–∏ **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å**
4. –í –ø–æ–ª–µ "–ê–¥—Ä–µ—Å" –≤–≤–µ–¥–∏: `https://—Ç–≤–æ–π-ngrok-url.ngrok-free.app/vk`

   –ù–∞–ø—Ä–∏–º–µ—Ä: `https://a1b2-c3d4-e5f6.ngrok-free.app/vk`

5. VK –ø–æ–∫–∞–∂–µ—Ç —Ç–µ–±–µ **–°—Ç—Ä–æ–∫—É –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è** (–∫–æ–¥ —Ç–∏–ø–∞ `abc123def`)
6. **–°–∫–æ–ø–∏—Ä—É–π** —ç—Ç–æ—Ç –∫–æ–¥
7. –û—Ç–∫—Ä–æ–π `.env` —Ñ–∞–π–ª –∏ –¥–æ–±–∞–≤—å:
   ```env
   VK_CONFIRMATION_CODE=abc123def
   ```
8. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏** –±–æ—Ç–∞ (Ctrl+C –≤ –ø–µ—Ä–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –∑–∞—Ç–µ–º `npm run dev` —Å–Ω–æ–≤–∞)
9. –í–µ—Ä–Ω–∏—Å—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ VK –∏ –Ω–∞–∂–º–∏ **–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å**
10. –í–∫–ª—é—á–∏ —Å–æ–±—ã—Ç–∏–µ **"–í—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è"** (message_new)
11. –ù–∞–∂–º–∏ **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å**

## –®–∞–≥ 7: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: Health Check

–í –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
```bash
curl http://localhost:3000/health
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:
```json
{"status":"ok","timestamp":"2026-01-20T..."}
```

### –¢–µ—Å—Ç 2: –†–µ–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ VK –≥—Ä—É–ø–ø—É –æ—Ç —Å–≤–æ–µ–≥–æ –∏–º–µ–Ω–∏.

–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Å –±–æ—Ç–æ–º —Ç—ã –¥–æ–ª–∂–µ–Ω —É–≤–∏–¥–µ—Ç—å –ª–æ–≥–∏:
```
üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç user –¥–ª—è peer_id=123456
üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç assistant –¥–ª—è peer_id=123456
```

–ë–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å —Ç–µ–±–µ –≤ VK!

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ùå VK –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç webhook

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ë–æ—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω
- ngrok –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `VK_CONFIRMATION_CODE` –≤ `.env`
- URL –≤ VK –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å ngrok URL

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –æ–±–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ —Ä–∞–±–æ—Ç–∞—é—Ç (–±–æ—Ç + ngrok)
2. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ URL —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞–µ—Ç
3. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª –±–æ—Ç–∞ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è `VK_CONFIRMATION_CODE`

### ‚ùå –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `OPENAI_API_KEY`
- –ù–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ OpenAI –∞–∫–∫–∞—É–Ω—Ç–µ
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `VK_ACCESS_TOKEN`

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å –±–∞–ª–∞–Ω—Å –Ω–∞ platform.openai.com
2. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ VK —Ç–æ–∫–µ–Ω –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π
3. –ü–æ—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Å –±–æ—Ç–æ–º

### ‚ùå ngrok URL –º–µ–Ω—è–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π ngrok –¥–∞—ë—Ç –∫–∞–∂–¥—ã–π —Ä–∞–∑ –Ω–æ–≤—ã–π URL

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ ngrok –æ–±–Ω–æ–≤–ª—è–π URL –≤ VK Callback API
2. –ò–ª–∏ –∫—É–ø–∏ ngrok –ø–ª–∞–Ω —Å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º URL

### ‚ùå –ò—Å—Ç–æ—Ä–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

**–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ!** In-memory —Ä–µ–∂–∏–º –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ.

–î–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è:
1. –£—Å—Ç–∞–Ω–æ–≤–∏ PostgreSQL: `brew install postgresql`
2. –°–æ–∑–¥–∞–π –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
3. –í `.env` –ø–æ—Å—Ç–∞–≤—å `USE_MEMORY_DB=false`
4. –ó–∞–ø–æ–ª–Ω–∏ POSTGRES –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞:

1. **–î–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã:**
   - –£—Å—Ç–∞–Ω–æ–≤–∏ PostgreSQL
   - –†–∞–∑–≤–µ—Ä–Ω–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (VPS, Railway.app, Render)

2. **–î–ª—è —É–ª—É—á—à–µ–Ω–∏—è –±–æ—Ç–∞:**
   - –ù–∞—Å—Ç—Ä–æ–π Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   - –†–µ–∞–ª–∏–∑—É–π search_flights –∏ search_hotels
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π —Å CRM

3. **–°–º. ROADMAP.md** –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–ª–∞–Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏—è

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Å –±–æ—Ç–æ–º: `Ctrl + C`

### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ngrok
–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Å ngrok: `Ctrl + C`

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ ngrok
–û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `http://localhost:4040`

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
curl http://localhost:3000/
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–æ–≤

–ö–æ–≥–¥–∞ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ç—ã —É–≤–∏–¥–∏—à—å –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

```
üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç user –¥–ª—è peer_id=123456
üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç assistant –¥–ª—è peer_id=123456
```

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç —á—Ç–æ:
1. ‚úÖ –ë–æ—Ç –ø–æ–ª—É—á–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç VK
2. ‚úÖ OpenAI —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª –æ—Ç–≤–µ—Ç
3. ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞—Å—å –≤ –ø–∞–º—è—Ç–∏
4. ‚úÖ –û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

---

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å —Ç–≤–æ–π –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ VK —á–µ—Ä–µ–∑ AI üéâ

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã - —Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∏–ª–∏ –ø–∏—à–∏ –≤ issues.
